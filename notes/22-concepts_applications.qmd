### 22. Applying Probes and Concepts

* application to case study

* testing concept vectors

* relationship with sufficiency

* user study evaluation

---

### Learning Outcomes

* Describe the theoretical foundation of post-hoc explanation methods like SHAP and linear probes values and apply them to realistic case studies with appropriate validation checks
* Analyze large-scale foundation models using methods like sparse autoencoders and describe their relevance to problems of model control and AI-driven design.
* Within a specific application context, evaluate the trade-offs associated with competing interpretable machine learning techniques.

---

### Readings

Alain, G., & Bengio, Y. (2017). Understanding intermediate layers using linear classifier probes. OpenReview. https://openreview.net/forum?id=ryF7rTqgl

Schmalwasser, L., Penzel, N., Denzler, J., & Niebling, J. (2025). FastCAV: Efficient computation of concept activation vectors for explaining deep neural networks. In Proceedings of the 42nd International Conference on Machine Learning. https://openreview.net/forum?id=kRmfzTfIGe

---

### `captum` package

---

### Extracting activations

---

### Concepts data structure

---

### Estimating concept directions

---

### Outputs

---

## Testing CAVs

---

### Spurious Concepts

(why we would want to test)

---

**Step 4**. Let $N_{k}$ be the number of images in class $k$, and define the test
statistic:

\begin{align*}
T_{k} = \frac{1}{N_{k}}\absarg{\{\*x \in \text{Class } k : S_{k}\left(\*x\right) > 0\}}.
\end{align*}

.center[
<span style="font-size: 18px;">
<img src="figures/concepts_step4.png" width=580/><br/>
We count the number of class $k$'s gradients that are in the same halfspace as $\*v$.<br/>
</span>
]

---

**Step 5** Test the significance of $T_{k}$ by learning reference $\*v$ trained
to distinguish randomly chosen example images.

.center[
<span style="font-size: 18px;">
<img src="figures/concepts_step5.png" width=700/><br/>
Random classification directions serve as a negative control.
</span>
]

---

### Real-World Example

Concepts have been applied to medical imaging tasks. In this example, concepts
give additional context about why a model might classify the lesion as a
melanoma.

.center[
<span style="font-size: 18px;">
<img src="figures/lucieri_fig5.png" width=800/> <br/>
Figure from `r Citep(bib, "Lucieri2022")`. In this case, the model is incorrect despite concepts suggesting the correct diagnosis.
</span>
]

---

## User Studies

---

### Goals

---

### Example Study

---

### Experimental Design

---

### Results

---

### Interpretation

---

### Exercise: Complementarity

---