---
title: Preprocessing
---

Source: https://git.embl.org/bvelten/graper_analyses/-/blob/master/CLL/CLLexample.R?ref_type=heads

```{r}
data("CLL_data", package="MOFAdata")
CLL_data <- CLL_data[1:3]
CLL_data <- lapply(CLL_data,t)
ngr <- sapply(CLL_data,ncol)
CLL_data <- Reduce(cbind, CLL_data)

#only include patient samples profiles in all three omics
CLL_data <- CLL_data[apply(CLL_data,1, function(p) !any(is.na(p))),]
dim(CLL_data)

# prepare design matrix and response
X <- CLL_data[,!grepl("D_002", colnames(CLL_data))]
y <- rowMeans(CLL_data[,grepl("D_002", colnames(CLL_data))])
annot <- rep(c("drug", "methylation", "RNA"), times = ngr-c(5,0,0)) # group annotations to drugs, meth and RNA
```


```{r}
library(fs)
data_dir <- path("data")

list(
    X = X,
    y = y,
    annotation = annot
) |>
    saveRDS(data_dir / "01-cll.rds")
```